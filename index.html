<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Our Love Story â€¢ Since 22/07</title>

  <!-- ================= FONTS ================= -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
  /* ================= DESIGN SYSTEM ================= */
  :root {
    --bg-dark: #05010d;
    --glass-bg: rgba(20,16,40,0.55);
    --glass-border: rgba(255,255,255,0.28);
    --accent: #ff9a9e;

    --radius-md: 18px;
    --radius-lg: 26px;

    --blur-strong: 26px;
    --blur-soft: 10px;

    --font-sub: clamp(0.95rem, 3.5vw, 1.05rem);
    --font-title: clamp(1.6rem, 5vw, 2.2rem);

    --t-base: 0.8s ease;
    --t-slow: 1.6s ease;
  }

  * { box-sizing: border-box; }

  body {
    margin: 0;
    font-family: 'Poppins', sans-serif;
    background: var(--bg-dark);
    color: #fff;
    overflow: hidden;
  }

  /* ================= BACKGROUND ================= */
  #bg {
    position: fixed;
    inset: 0;
    z-index: -3;
    background-size: cover;
    background-position: center;
    filter: blur(var(--blur-strong)) brightness(0.55);
    transform: scale(1.1);
    transition: background-image 1.8s ease;
  }

  /* ================= MAIN IMAGE ================= */
  #stage {
    position: fixed;
    inset: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: -1;
    pointer-events: none;
  }

  #stage img {
    max-width: 92vw;
    max-height: 88svh;
    object-fit: contain;
    border-radius: var(--radius-lg);
    box-shadow: 0 40px 120px rgba(0,0,0,0.7);
    opacity: 0;
    transform: scale(0.98);
    transition: opacity var(--t-slow), transform var(--t-slow);
  }

  #stage img.active { opacity: 1; transform: scale(1); }

  /* ================= ANNIVERSARY ================= */
  .anniversary {
    position: fixed;
    top: calc(env(safe-area-inset-top) + 18px);
    left: 50%;
    transform: translateX(-50%);
    font-family: 'Playfair Display', serif;
    font-size: var(--font-title);
    letter-spacing: 1px;
    padding: 8px 18px;
    border-radius: 999px;
    background: rgba(0,0,0,0.35);
    backdrop-filter: blur(var(--blur-soft));
    border: 1px solid var(--glass-border);
    opacity: 0;
    transition: opacity var(--t-slow);
    z-index: 5;
  }
  .anniversary.show { opacity: 1; }

  /* ================= SUBTITLE ================= */
  .subtitle-wrap {
    position: fixed;
    left: 50%;
    bottom: calc(env(safe-area-inset-bottom) + 22px);
    transform: translateX(-50%);
    width: 100%;
    display: flex;
    justify-content: center;
    pointer-events: none;
    z-index: 4;
  }

  .subtitle-box {
    max-width: min(92vw, 560px);
    padding: 12px 16px;
    background: var(--glass-bg);
    backdrop-filter: blur(var(--blur-soft));
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
  }

  .subtitle-line {
    font-size: var(--font-sub);
    line-height: 1.6;
    text-align: center;
    opacity: 0;
    transform: translateY(6px);
    transition: opacity var(--t-base), transform var(--t-base);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .subtitle-line.show { opacity: 1; transform: translateY(0); }
  .subtitle-line.exit { opacity: 0; transform: translateY(-6px); }

  /* ================= MUSIC ================= */
  .music-btn {
    position: fixed;
    top: calc(env(safe-area-inset-top) + 18px);
    right: 18px;
    padding: 10px 18px;
    border-radius: 999px;
    background: rgba(0,0,0,0.45);
    backdrop-filter: blur(var(--blur-soft));
    border: 1px solid var(--glass-border);
    cursor: pointer;
    font-size: 0.9rem;
    z-index: 6;
  }

  /* ================= HEART ================= */
  .heart {
    position: fixed;
    bottom: -20px;
    animation: fly 7s linear forwards;
    pointer-events: none;
    z-index: 3;
  }
  @keyframes fly { to { transform: translateY(-120vh) scale(1.6); opacity: 0; } }

  /* ================= LOCK ================= */
  #lock {
    position: fixed;
    inset: 0;
    background: linear-gradient(145deg, #2f1c6b, #0b0320);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 14px;
    text-align: center;
    z-index: 9999;
  }

  #lock h2 { font-family: 'Playfair Display', serif; font-size: 2.2rem; margin: 0; }
  #lock input { padding: 14px 18px; border-radius: 999px; border: none; font-size: 1rem; text-align: center; width: 220px; }
  #lock button { padding: 12px 30px; border-radius: 999px; border: none; background: linear-gradient(135deg, var(--accent), #fad0c4); font-size: 1rem; cursor: pointer; }
  </style>
</head>
<body>

<div id="bg"></div>
<div id="stage"></div>

<div class="anniversary" id="anniversary">Since 22/07 â€¢ The day we began</div>

<div class="subtitle-wrap"><div class="subtitle-box"><div class="subtitle-line" id="subtitle"></div></div></div>

<audio id="music" loop preload="auto" playsinline><source src="music.mp3" type="audio/mpeg" /></audio>
<div class="music-btn" id="musicToggle">ðŸ”Š Music</div>

<div id="lock"><h2>ðŸ”’ NgÃ y chÃºng ta báº¯t Ä‘áº§u</h2><input id="pass" placeholder="22/07" /><button id="unlockBtn">Má»Ÿ khoÃ¡ ðŸ’–</button></div>

<script>
/* ================= CONFIG ================= */
const PASSWORD = '22/07';
const MAX_INDEX = 76; // Sá» áº¢NH THáº¬T
const EXTENSIONS = ['jpg','png','JPG','PNG'];

/* ================= SUBTITLE ================= */
const subtitles = [
  'Gá»­i em â€“ ngÆ°á»i Ä‘Ã£ bÆ°á»›c vÃ o cuá»™c Ä‘á»i anh tá»« ngÃ y 22/07.',
  'Má»™t nÄƒm qua, anh vÃ  em Ä‘Ã£ Ä‘i cÃ¹ng nhau qua ráº¥t nhiá»u khoáº£nh kháº¯c.',
  'CÃ³ nhá»¯ng ngÃ y ráº¥t vui, cÃ³ nhá»¯ng ngÃ y má»‡t má»i, cÃ³ lÃºc cÆ°á»i tháº­t nhiá»u vÃ  cÅ©ng cÃ³ lÃºc im láº·ng ráº¥t lÃ¢u.',
  'NhÆ°ng Ä‘iá»u quan trá»ng nháº¥t lÃ : chÃºng ta chÆ°a tá»«ng rá»i khá»i nhau.',
  'Web nÃ y khÃ´ng pháº£i Ä‘á»ƒ khoe nhá»¯ng khoáº£nh kháº¯c hoÃ n háº£o.',
  'MÃ  Ä‘á»ƒ nháº¯c anh nhá»› ráº±ng tá»«ng táº¥m áº£nh á»Ÿ Ä‘Ã¢y Ä‘á»u lÃ  má»™t máº£nh kÃ½ á»©c ráº¥t trÃ¢n trá»ng.',
  'VÃ¬ trong Ä‘Ã³ luÃ´n cÃ³ anh vÃ  em.',
  'BÆ°á»›c sang nÄƒm má»›i, anh khÃ´ng mong má»i thá»© sáº½ luÃ´n dá»… dÃ ng.',
  'Anh chá»‰ mong ráº±ng dÃ¹ cÃ³ chuyá»‡n gÃ¬ xáº£y ra, chÃºng ta váº«n chá»n á»Ÿ láº¡i bÃªn nhau.',
  'Váº«n náº¯m tay nhau Ä‘i tiáº¿p, cháº­m cÅ©ng Ä‘Æ°á»£c, miá»…n lÃ  cÃ¹ng nhau.',
  'ChÃºc má»«ng nÄƒm má»›i, em yÃªu.',
  'Cáº£m Æ¡n em vÃ¬ Ä‘Ã£ lÃ  má»™t pháº§n trong hÃ nh trÃ¬nh cá»§a anh.',
  'VÃ  anh hy vá»ng ráº±ng nhá»¯ng trang tiáº¿p theoâ€¦',
  'Váº«n luÃ´n cÃ³ tÃªn cá»§a hai Ä‘á»©a mÃ¬nh. ðŸ¤'
];

const subtitleEl = document.getElementById('subtitle');
let subtitleIndex = 0;
function playSubtitle() {
  subtitleEl.classList.remove('show');
  subtitleEl.classList.add('exit');
  setTimeout(() => {
    subtitleEl.classList.remove('exit');
    subtitleEl.textContent = subtitles[subtitleIndex % subtitles.length];
    subtitleEl.classList.add('show');
    subtitleIndex++;
  }, 500);
}

/* ================= IMAGE ENGINE (FIX DUPLICATE) ================= */
const bg = document.getElementById('bg');
const stage = document.getElementById('stage');
let slides = [];
let imgIndex = 0;
let ready = false;

async function loadImages() {
  const added = new Set();
  for (let i = 1; i <= MAX_INDEX; i++) {
    for (const ext of EXTENSIONS) {
      const src = `images/${i}.${ext}`;
      try {
        const res = await fetch(src, { method: 'HEAD' });
        if (res.ok && !added.has(i)) {
          slides.push(src);
          added.add(i); // CHá»ˆ 1 áº¢NH / 1 INDEX
          break;
        }
      } catch (e) {}
    }
  }
  ready = true;
}

function showNextImage() {
  if (!ready || slides.length === 0) return;
  const src = slides[imgIndex % slides.length];
  bg.style.backgroundImage = `url(${src})`;
  const img = document.createElement('img');
  img.src = src;
  stage.innerHTML = '';
  stage.appendChild(img);
  requestAnimationFrame(() => img.classList.add('active'));
  imgIndex++;
}

/* ================= MUSIC ================= */
const music = document.getElementById('music');
const musicToggle = document.getElementById('musicToggle');
music.volume = 0.8;
musicToggle.onclick = () => {
  if (music.paused) {
    music.play(); musicToggle.textContent = 'ðŸ”Š Music';
  } else {
    music.pause(); musicToggle.textContent = 'ðŸ”‡ Music';
  }
};

/* ================= LOCK ================= */
const lock = document.getElementById('lock');
const unlockBtn = document.getElementById('unlockBtn');
const anniversary = document.getElementById('anniversary');

unlockBtn.onclick = async () => {
  if (document.getElementById('pass').value !== PASSWORD) {
    alert('Sai ngÃ y rá»“i ðŸ˜'); return;
  }
  lock.style.display = 'none';
  anniversary.classList.add('show');
  music.play().catch(()=>{});

  await loadImages();
  showNextImage();
  setInterval(showNextImage, 3000);

  playSubtitle();
  setInterval(playSubtitle, 5000);
};

/* ================= HEART ================= */
setInterval(() => {
  const h = document.createElement('div');
  h.className = 'heart';
  h.innerText = 'â¤ï¸';
  h.style.left = Math.random() * 100 + 'vw';
  h.style.fontSize = 16 + Math.random() * 26 + 'px';
  document.body.appendChild(h);
  setTimeout(() => h.remove(), 7000);
}, 1400);
</script>

</body>
</html>